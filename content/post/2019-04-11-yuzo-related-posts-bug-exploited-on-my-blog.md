---
title: Yuzo Related Posts bug exploited on my blog
author: ヤング marduc
type: post
date: 2019-04-11T17:04:33+00:00
url: /2019/04/11/yuzo-related-posts-bug-exploited-on-my-blog/
featured_image: /wp-content/uploads/2019/04/xss-yuzo-622x293.jpg
mashsb_timestamp:
  - 1583180812
mashsb_jsonshares:
  - '{"total":0,"error":{"facebook_error":"{"error":{"message":"(#12) share field is deprecated for versions v2.9 and higher","type":"OAuthException","code":12,"fbtrace_id":"AjdvGI89aT_VXUbZ1_1RUNp"}}"},"facebook_total":0}'
categories:
  - Security
  - Tuts
tags:
  - Security

---
<div class="wp-block-jetpack-markdown">
  <p>
    So today I loaded my website and while it was loading, I noticed that it wasn&#8217;t actually loading my starting page but it tried to redirect me to <code>hellofromhony.com</code>. Of course, it is visible that something was wrong, so using <code>Burp Suite</code> I tried to follow the order of the events in order to understand when the redirection happened.
  </p>
</div>

<!--more--><figure class="wp-block-image">

<img src="http://localhost/wp-content/uploads/2019/04/requests.jpg" alt="" class="wp-image-1067" srcset="http://localhost/wp-content/uploads/2019/04/requests.jpg 709w, http://localhost/wp-content/uploads/2019/04/requests-300x45.jpg 300w" sizes="(max-width: 709px) 100vw, 709px" /> <figcaption>Suspicious request on #68</figcaption></figure> 

It is visible that there was something wrong with the Yuzo plugin, since suddenly it was replying with 404. After some Googling multiple results came from the last 24 hours telling that there is an issue with the plugin, and that some people are exploiting this issue to redirect people on spam websites.

Wordfence has an in depth explanation of what is the issue in this case. I will leave the link for the post at the end of this page.

<div class="wp-block-jetpack-markdown">
  <h3>
    How to fix the redirect
  </h3>
  
  <p>
    My first thought was to uninstall it from the plugins of WordPress directly, but it wasn&#8217;t there, meaning that it needs to be done through cpanel. After logging in, I went to the Database of my WordPress instance and looked for the <code>wp-options</code> trying to find a reference for <code>Yuzo</code>. Since the XSS vulnerability is located inside the style page, I deleted the <code>yuzo_related_post_options</code> record.
  </p>
  
  <p>
    This stopped the redirect and finally the starting page loaded again.
  </p>
</div>

<div class="wp-block-jetpack-markdown">
  <h3>
    References
  </h3>
  
  <ul>
    <li>
      <a href="https://www.wordfence.com/blog/2019/04/yuzo-related-posts-zero-day-vulnerability-exploited-in-the-wild/">Wordfence Post</a>
    </li>
    <li>
      <a href="https://www.pluginvulnerabilities.com/2019/03/30/wordpress-plugin-team-paints-target-on-exploitable-settings-change-vulnerability-that-permits-persistent-xss-in-related-posts/">Vulnerability PoC</a>
    </li>
  </ul>
  
  <p>
    <strong>note</strong> A google search returns multiple website with the plugin enabled. I believe even more people will get affected by that issue.
  </p>
</div>